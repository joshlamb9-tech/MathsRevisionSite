---
phase: 04.1-site-polish
plan: "01"
subsystem: css-maintainability
tags: [css, html, refactor, foundation, additional, desmos, frontmatter]
one-liner: "CSS badge class extraction (.non-calc-badge) across 6 Foundation pages, purple Desmos toggle on Pythagoras via .page-additional scoping, and standardised Phase 4 SUMMARY frontmatter"
dependency-graph:
  requires:
    - 02-01 (Foundation content — original inline badge styles authored here)
    - 04-02 (Pythagoras page — Desmos toggle button to fix)
  provides:
    - .non-calc-badge CSS class (single source of truth for green badge)
    - .page-additional .desmos-toggle-btn override (purple button on Additional pages)
    - requirements-completed field in 04-01 and 04-02 SUMMARYs (gsd tooling compatibility)
  affects:
    - All 6 Foundation topic pages (badge now class-driven)
    - additional/pythagoras/index.html (body class added)
    - Phase 4 SUMMARY parsing by gsd summary-extract
key-files:
  created: []
  modified:
    - assets/css/styles.css
    - foundation/fractions/index.html
    - foundation/division/index.html
    - foundation/prime-factors/index.html
    - foundation/estimation/index.html
    - foundation/long-multiplication/index.html
    - foundation/averages/index.html
    - additional/pythagoras/index.html
    - .planning/phases/04-additional-content/04-01-SUMMARY.md
    - .planning/phases/04-additional-content/04-02-SUMMARY.md
decisions:
  - "[04.1-01]: .page-additional scoping approach chosen for Desmos button override — avoids touching existing .desmos-toggle-btn rule, zero risk of breaking Core pages"
  - "[04.1-01]: .non-calc-badge placed in LEVEL BADGE section of styles.css — logical grouping with level-badge rules"
requirements-completed: [INFRA-04, DESIGN-04]
metrics:
  duration: "2 min"
  completed: "2026-02-27"
  tasks-completed: 3
  tasks-total: 3
  files-modified: 10
---

# Phase 4.1 Plan 01: Site Polish — Badge CSS Extraction and SUMMARY Standardisation

CSS badge class extraction, purple Desmos toggle on Pythagoras, and Phase 4 SUMMARY frontmatter standardisation.

## What Was Built

### Task 1: Extract non-calc badge inline styles to .non-calc-badge CSS class

All 6 Foundation topic pages previously used a lengthy `style=` attribute on the Non-calculator badge element. This was extracted into a reusable `.non-calc-badge` CSS class in `assets/css/styles.css`.

**CSS added** (in LEVEL BADGE section of styles.css):
```css
.non-calc-badge {
  display: inline-block;
  background: #e8f5e9;
  color: #2e7d32;
  border: 1px solid #a5d6a7;
  border-radius: 4px;
  padding: 0.25rem 0.75rem;
  font-size: 0.85rem;
  font-weight: 600;
  margin: 0.5rem 0 1.5rem;
}
```

**Pages updated** — all 6 Foundation pages now use `<p class="non-calc-badge">` instead of the 130-character inline style:
- `foundation/fractions/index.html`
- `foundation/division/index.html`
- `foundation/prime-factors/index.html`
- `foundation/estimation/index.html`
- `foundation/long-multiplication/index.html`
- `foundation/averages/index.html`

### Task 2: Fix Desmos toggle button colour on Pythagoras page

The `.desmos-toggle-btn` global rule uses `var(--core-accent)` (blue, #2563eb). On the Pythagoras page (an Additional level page), the button should be purple (#7c3aed) to match the Additional brand.

**Fix:** Added `class="page-additional"` to the `<body>` tag on `additional/pythagoras/index.html`, then added a scoped CSS override at the end of `styles.css`:
```css
.page-additional .desmos-toggle-btn {
  background: var(--additional-accent);
}
```

The existing `.desmos-toggle-btn` rule (blue) is unchanged — the override only applies when `.page-additional` is present on the body.

### Task 3: Standardise Phase 4 SUMMARY frontmatter

Both Phase 4 SUMMARY files used non-standard frontmatter fields that the `gsd summary-extract` tool cannot parse.

- **04-01-SUMMARY.md**: Replaced `provides: [ADD-01, ADD-02]` and removed `affects:` line; added `requirements-completed: [ADD-01, ADD-02]`
- **04-02-SUMMARY.md**: Replaced multi-line `provides:` block with `requirements-completed: [ADD-03, GRAPH-04]`; removed `tech-stack` block and `affects:` items (captured in body prose and STATE.md decisions already)

## Commits

| Task | Hash | Description |
|------|------|-------------|
| 1 | `52dbe8a` | feat(04.1-01): extract non-calc badge inline styles to .non-calc-badge CSS class |
| 2 | `0d254e5` | fix(04.1-01): fix Desmos toggle button colour to purple on Pythagoras page |
| 3 | `f62b7f8` | chore(04.1-01): standardise Phase 4 SUMMARY frontmatter to requirements-completed field |

## Verification

All success criteria confirmed:

1. `styles.css` contains `.non-calc-badge` with `background: #e8f5e9`, `color: #2e7d32`, `border: 1px solid #a5d6a7` — PASS
2. All 6 Foundation pages use `class="non-calc-badge"` — zero `style=` attributes on badge elements — PASS
3. `styles.css` contains `.page-additional .desmos-toggle-btn { background: var(--additional-accent); }` — PASS
4. `additional/pythagoras/index.html` has `class="page-additional"` on its body tag — PASS
5. `04-01-SUMMARY.md` frontmatter contains `requirements-completed: [ADD-01, ADD-02]` — PASS
6. `04-02-SUMMARY.md` frontmatter contains `requirements-completed: [ADD-03, GRAPH-04]` — PASS

## Deviations from Plan

None — plan executed exactly as written.

## Self-Check: PASSED
