---
phase: 04-additional-content
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - additional/pythagoras/index.html
autonomous: true
requirements:
  - ADD-03
  - GRAPH-04

must_haves:
  truths:
    - "Pupil can open the Pythagoras page and read Key Facts including the theorem, hypotenuse identification rule, and Pythagorean triples"
    - "Pupil can follow Worked Example 1 — finding the hypotenuse of a 6-8-10 triangle — with display KaTeX at each step"
    - "Pupil can follow Worked Example 2 — finding a shorter side (5-12-13 triple) — with the rearrangement step shown explicitly"
    - "Pupil can see and interact with a Desmos graph showing a right-angled triangle with sliders for legs a and b and a live hypotenuse calculation c = sqrt(a^2 + b^2)"
    - "On mobile, the Desmos graph does not trap the page scroll — the toggle button switches between interact and scroll modes"
    - "No non-calculator badge on the page"
  artifacts:
    - path: "additional/pythagoras/index.html"
      provides: "Pythagoras topic page with Key Facts, 2 worked examples, and Desmos embed"
      min_lines: 160
      contains: "desmos-wrapper-pyth"
  key_links:
    - from: "additional/pythagoras/index.html"
      to: "https://www.desmos.com/api/v1.11/calculator.js"
      via: "Desmos script tag in <head>"
      pattern: "desmos.com/api/v1.11"
    - from: "desmos-calculator div"
      to: "desmos-wrapper-pyth div"
      via: "JavaScript GraphingCalculator init"
      pattern: "getElementById\\('desmos-calculator'\\)"
    - from: "toggleDesmosInteraction"
      to: "desmos-wrapper-pyth"
      via: "classList.toggle('interactive')"
      pattern: "desmos-wrapper-pyth"
---

<objective>
Author the Pythagoras Additional-level topic page — replacing the existing stub content with fully worked KaTeX content and adding a Desmos interactive graph embed (GRAPH-04).

Purpose: Completes ADD-03 and GRAPH-04, giving pupils a worked Pythagoras page with an interactive right-triangle graph they can explore with a and b sliders.
Output: One complete HTML topic page with KaTeX content and a scroll-friendly Desmos embed.
</objective>

<execution_context>
@/Users/josh/.claude/get-shit-done/workflows/execute-plan.md
@/Users/josh/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-additional-content/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Author Pythagoras page with Desmos embed (ADD-03, GRAPH-04)</name>
  <files>additional/pythagoras/index.html</files>
  <action>
    Replace the placeholder paragraph in `additional/pythagoras/index.html` with fully authored content AND add the Desmos script tag to the `<head>`. This is the ONLY Additional page that gets the Desmos script — do NOT add it to index-laws or expanding-factorising.

    **Step 1 — Add Desmos script tag to `<head>`**

    After the KaTeX `auto-render.min.js` script block and before `</head>`, add:
    ```html
    <!-- Desmos API v1.11 — REPLACE WITH PRODUCTION KEY BEFORE GO-LIVE (request from partnerships@desmos.com) -->
    <script src="https://www.desmos.com/api/v1.11/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"></script>
    ```

    **Step 2 — Replace `<main>` block content**

    1. Breadcrumb:
       ```html
       <p class="breadcrumb">
         <a href="/MathsRevisionSite/">Home</a> &rsaquo;
         <a href="/MathsRevisionSite/additional/">Additional</a> &rsaquo;
         Pythagoras
       </p>
       ```

    2. Level badge and heading — NO non-calculator badge:
       ```html
       <span class="level-badge additional">Additional</span>
       <h1 class="page-title">Pythagoras' Theorem</h1>
       ```

    3. Key Facts section:
       - Main theorem (display): $$a^2 + b^2 = c^2$$
       - "The hypotenuse ($c$) is the side OPPOSITE the right angle — always the longest side. Identify it first."
       - Finding the hypotenuse (display): $$c = \sqrt{a^2 + b^2}$$
       - Finding a shorter side (display): $$a = \sqrt{c^2 - b^2}$$
       - Classic Pythagorean triples: 3-4-5, 5-12-13, 8-15-17 (if sides are multiples of these, it's a right-angled triangle)

    4. Worked Example 1: "A right-angled triangle has legs of 6 cm and 8 cm. Find the hypotenuse."
       - Step 1: Identify the hypotenuse $c$ — it is the side opposite the right angle (the unknown here)
       - Step 2: Apply Pythagoras' Theorem: $$c^2 = a^2 + b^2$$
       - Step 3: Substitute known values: $$c^2 = 6^2 + 8^2 = 36 + 64 = 100$$
       - Step 4: Take the square root: $$c = \sqrt{100} = 10 \text{ cm}$$
       - Answer: The hypotenuse is 10 cm (this is the 6-8-10 triple, a multiple of 3-4-5)

    5. Worked Example 2: "A right-angled triangle has a hypotenuse of 13 cm and one leg of 5 cm. Find the missing leg."
       - Step 1: Identify: hypotenuse $c = 13$ cm (longest side, opposite right angle); known leg $b = 5$ cm; find $a$
       - Step 2: Rearrange the theorem to find a shorter side: $$a^2 = c^2 - b^2$$
       - Step 3: Substitute: $$a^2 = 13^2 - 5^2 = 169 - 25 = 144$$
       - Step 4: Take the square root: $$a = \sqrt{144} = 12 \text{ cm}$$
       - Answer: The missing leg is 12 cm (the classic 5-12-13 Pythagorean triple)

    6. Desmos embed section — add after the worked examples, inside `<main>`:
       ```html
       <h2>Explore with Desmos</h2>
       <p>Use the graph below to explore Pythagoras' Theorem. The right-angled triangle has legs $a$ and $b$ and hypotenuse $c$. Adjust the sliders to see how changing the side lengths affects $c = \sqrt{a^2 + b^2}$.</p>

       <button class="desmos-toggle-btn" onclick="toggleDesmosInteraction(this)" aria-label="Toggle graph interaction">
         Tap to interact with graph
       </button>

       <div class="desmos-wrapper" id="desmos-wrapper-pyth">
         <div id="desmos-calculator"></div>
         <div class="desmos-scroll-overlay" aria-hidden="true"></div>
       </div>

       <script>
         var elt = document.getElementById('desmos-calculator');
         var calculator = Desmos.GraphingCalculator(elt, {
           expressions: true,
           settingsMenu: false,
           zoomButtons: true,
           lockViewport: false
         });
         calculator.setExpression({ id: 'slider_a', latex: 'a = 3', sliderBounds: { min: 1, max: 10, step: 1 } });
         calculator.setExpression({ id: 'slider_b', latex: 'b = 4', sliderBounds: { min: 1, max: 10, step: 1 } });
         calculator.setExpression({ id: 'hyp', latex: 'c = \\sqrt{a^2 + b^2}', color: '#7c3aed' });
         calculator.setExpression({ id: 'triangle', latex: 'polygon((0,0),(a,0),(0,b))', color: '#7c3aed' });

         function toggleDesmosInteraction(btn) {
           var wrapper = document.getElementById('desmos-wrapper-pyth');
           wrapper.classList.toggle('interactive');
           btn.textContent = wrapper.classList.contains('interactive')
             ? 'Scroll page (tap to switch)'
             : 'Tap to interact with graph';
         }
       </script>
       ```

    Critical checks:
    - Wrapper ID must be `desmos-wrapper-pyth` (scoped — avoids conflicts with other Desmos pages per Phase 3 decision)
    - `toggleDesmosInteraction` function references `desmos-wrapper-pyth` — not any other ID
    - Desmos script tag added to `<head>` ONLY on this page
    - `expressions: true` in the constructor (per Phase 3 decision: shows slider panel so pupils see a, b, c updating live)
    - Default values $a = 3$, $b = 4$ (the 3-4-5 triple — pupils can see it works immediately)
    - Nav `active` class is on `Additional` link
    - No non-calculator badge
  </action>
  <verify>
    <automated>grep -c "desmos-wrapper-pyth" /Users/josh/projects/maths-revision/additional/pythagoras/index.html && grep -c "level-badge additional" /Users/josh/projects/maths-revision/additional/pythagoras/index.html && grep -c "Worked Example" /Users/josh/projects/maths-revision/additional/pythagoras/index.html && wc -l &lt; /Users/josh/projects/maths-revision/additional/pythagoras/index.html</automated>
    <manual>Open additional/pythagoras/index.html in a browser. Verify: purple "Additional" badge, KaTeX theorem renders, both worked examples present, Desmos graph loads with right-angled triangle visible at a=3, b=4, sliders in expression panel, toggle button visible on mobile viewport, no non-calc badge.</manual>
  </verify>
  <done>Pythagoras page has Key Facts (theorem, hypotenuse rule, triples), 2 worked examples (finding hypotenuse and finding a leg), and a Desmos graph with a/b sliders and live c calculation. Wrapper ID is desmos-wrapper-pyth. Toggle button present for mobile scroll fix. No non-calc badge. File is 160+ lines.</done>
</task>

</tasks>

<verification>
Page loads in browser with:
- Purple "Additional" level badge visible
- KaTeX equations rendering correctly including sqrt and squared notation
- Two worked examples with numbered steps
- Desmos graph displays a right-angled triangle (3-4-5 default) with expression panel showing a, b, c
- Toggle button visible on narrow (mobile) viewport
- Breadcrumb shows Home > Additional > Pythagoras
- Nav "Additional" link is active (gold highlight)
- No non-calculator badge
</verification>

<success_criteria>
ADD-03 and GRAPH-04 complete: pupils can access the Pythagoras worked examples and interact with the Desmos right-triangle graph. Mobile scroll is handled by the existing CSS overlay toggle pattern.
</success_criteria>

<output>
After completion, create `.planning/phases/04-additional-content/04-02-SUMMARY.md`
</output>
