/* ============================================================
   MATHS REVISION — Year 8 CE  |  Mowden Hall
   Font: Dosis (Google Fonts)
   Colours: Mowden Hall brand colours (confirmed 2026-02-27)
            --mh-navy = Pantone 330C (dark green) #00534C
            --mh-gold = Pantone 704C (dark red)   #81001C
   ============================================================ */

@import url('https://fonts.googleapis.com/css2?family=Dosis:wght@300;400;500;600;700;800&display=swap');

/* ─── DESIGN TOKENS ─── */
:root {
  --mh-navy:         #00534C;   /* Pantone 330C — Mowden green */
  --mh-gold:         #81001C;   /* Pantone 704C — Mowden red   */
  --mh-navy-light:   #006b61;
  --bg:              #f4f2ef;
  --white:           #ffffff;
  --text:            #18181b;
  --text-mid:        #3f3f46;
  --text-muted:      #71717a;
  --border:          #e4e4e7;
  --foundation-bg:   #fef3c7;
  --foundation-accent: #d97706;
  --core-bg:         #dbeafe;
  --core-accent:     #2563eb;
  --additional-bg:   #ede9fe;
  --additional-accent: #7c3aed;
}

/* ─── RESET ─── */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

/* ─── FOCUS STATES ─── */
/* Visible ring for keyboard / assistive-tech users.
   Inputs use a box-shadow ring instead (see .ma-answer-input:focus). */
:focus-visible {
  outline: 3px solid var(--mh-navy);
  outline-offset: 3px;
  border-radius: 4px;
}

/* ─── BODY ─── */
body {
  font-family: 'Dosis', sans-serif;
  background: var(--bg);
  color: var(--text);
  overflow-x: hidden;
  line-height: 1.65;
}

/* ─── HEADER ─── */
.site-header {
  background: var(--mh-navy);
  color: var(--white);
}

.header-inner {
  max-width: 900px;
  margin: 0 auto;
  padding: 0.75rem 1rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.brand-name {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--white);
}

.brand-sub {
  font-size: 0.75rem;
  color: rgba(255, 255, 255, 0.7);
}

.header-nav {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
}

.hn-link {
  color: var(--white);
  text-decoration: none;
  font-weight: 500;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
}

.hn-link:hover {
  background: var(--mh-navy-light);
}

.hn-link.active {
  background: var(--mh-gold);
  color: var(--white);
}

/* ─── MAIN CONTENT ─── */
.main-content {
  max-width: 900px;
  margin: 0 auto;
  padding: 1.5rem 1rem;
}

/* ─── TOPIC PAGE CONTENT SPACING ─── */
.main-content h2 {
  margin-top: 2.25rem;
  margin-bottom: 0.75rem;
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--mh-navy);
}

.main-content h3 {
  margin-top: 1.25rem;
  margin-bottom: 0.5rem;
  font-size: 1.05rem;
  font-weight: 700;
}

.main-content p {
  margin-bottom: 0.75rem;
}

.main-content ul,
.main-content ol {
  padding-left: 1.6rem;
  margin: 0.5rem 0 1rem;
  list-style-position: outside;
}

.main-content li {
  margin-bottom: 0;
  padding: 0.55rem 0.6rem 0.55rem 0.4rem;
  line-height: 2.1;
  border-radius: 0 5px 5px 0;
}

/* SEN reader stripes — alternating tint on every other list item */
.main-content li:nth-child(odd) {
  background: rgba(0, 83, 76, 0.06);
}

.main-content ol > li {
  margin-bottom: 0;
}

/* ─── WIP BANNER ─── */
.wip-banner {
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  background: #fffbeb;
  border: 1.5px solid #fbbf24;
  border-radius: 8px;
  padding: 0.85rem 1rem;
  margin: 1.25rem 0 1.75rem;
  font-size: 0.9rem;
  line-height: 1.55;
  color: #78350f;
}

.wip-banner-icon {
  font-size: 1.1rem;
  flex-shrink: 0;
  margin-top: 0.05rem;
}

/* ─── CALCULATION DISPLAY ─── */
/* Used for bus-stop division, column multiplication, factor trees */
.calc-display {
  background: var(--white);
  border: 1.5px solid var(--border);
  border-radius: 8px;
  padding: 1.25rem 1.5rem;
  margin: 1rem 0;
  font-family: 'Dosis', monospace;
  font-size: 1rem;
  line-height: 1.9;
  overflow-x: auto;
}

.calc-display .cd-row {
  display: flex;
  align-items: baseline;
  gap: 0;
  white-space: pre;
}

.calc-display .cd-line {
  border-top: 2px solid var(--text);
  margin: 0.15rem 0;
}

.calc-display .cd-label {
  font-size: 0.78rem;
  font-weight: 600;
  color: var(--text-muted);
  margin-left: 1rem;
  letter-spacing: 0.04em;
}

/* Factor tree */
.factor-tree {
  background: var(--white);
  border: 1.5px solid var(--border);
  border-radius: 8px;
  padding: 1.25rem 1.5rem;
  margin: 1rem 0;
  overflow-x: auto;
}

.ft-row {
  display: flex;
  justify-content: center;
  gap: 1.5rem;
  margin-bottom: 0;
  position: relative;
}

.ft-node {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0;
}

.ft-num {
  width: 38px; height: 38px;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-weight: 700; font-size: 0.95rem;
  border: 2px solid var(--border);
  background: var(--white);
}

.ft-num.prime {
  background: #d1fae5;
  border-color: #6ee7b7;
  color: #065f46;
}

.ft-branch {
  display: flex;
  gap: 1.5rem;
  position: relative;
}

.ft-branch::before {
  content: '';
  position: absolute;
  top: -12px; left: 50%; right: 50%;
  border-top: 2px solid var(--text-muted);
  width: 100%;
  transform: translateX(-50%);
}

/* ─── HERO ─── */
.hero {
  text-align: center;
  padding: 2rem 0 1.5rem;
}

.hero h1 {
  font-size: 2rem;
  font-weight: 800;
  color: var(--mh-navy);
  margin-bottom: 0.5rem;
}

.hero p {
  color: var(--text-mid);
  font-size: 1.1rem;
}

/* ─── LEVEL CARDS ─── */
.level-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1rem;
  margin-top: 1.5rem;
}

.level-card {
  display: block;
  border-radius: 12px;
  padding: 1.25rem;
  text-decoration: none;
  cursor: pointer;
  border: 1px solid var(--border);
  box-shadow: 0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
  transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
}

.level-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.10), 0 3px 8px rgba(0,0,0,0.07);
}

.level-card.foundation {
  background: var(--foundation-bg);
  border-color: var(--foundation-accent);
}

.level-card.core {
  background: var(--core-bg);
  border-color: var(--core-accent);
}

.level-card.additional {
  background: var(--additional-bg);
  border-color: var(--additional-accent);
}

.level-card h2 {
  font-size: 1.2rem;
  font-weight: 700;
  margin: 0 0 0.25rem;
}

.level-card p {
  font-size: 0.9rem;
  color: var(--text-mid);
  margin: 0;
}

/* ─── TOPIC LIST ─── */
.topic-list {
  list-style: none;
  padding: 0;
  margin: 1rem 0;
}

.topic-list li {
  margin: 0;
}

.topic-list a {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.6rem 0.75rem;
  border-radius: 8px;
  text-decoration: none;
  color: var(--text);
  border: 1px solid var(--border);
  margin-bottom: 0.5rem;
  font-weight: 500;
  box-shadow: 0 1px 2px rgba(0,0,0,0.04);
  transition: border-color 0.15s, background 0.15s, box-shadow 0.15s;
}

.topic-list a::after {
  content: '→';
  color: var(--text-muted);
  flex-shrink: 0;
  transition: color 0.15s, transform 0.15s;
}

.topic-list a:hover {
  background: var(--white);
  border-color: var(--mh-navy);
  box-shadow: 0 2px 6px rgba(0,83,76,0.10);
}

.topic-list a:hover::after {
  color: var(--mh-navy);
  transform: translateX(3px);
}

/* ─── BREADCRUMB ─── */
.breadcrumb {
  font-size: 0.85rem;
  color: var(--text-muted);
  margin-bottom: 1rem;
}

.breadcrumb a {
  color: var(--text-mid);
  text-decoration: none;
}

.breadcrumb a:hover {
  text-decoration: underline;
}

/* ─── PAGE TITLE ─── */
.page-title {
  font-size: 1.6rem;
  font-weight: 800;
  color: var(--mh-navy);
  margin: 0 0 0.25rem;
}

/* ─── LEVEL BADGE ─── */
.level-badge {
  display: inline-block;
  font-size: 0.75rem;
  font-weight: 600;
  padding: 0.2rem 0.6rem;
  border-radius: 999px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 1rem;
}

.level-badge.foundation {
  background: var(--foundation-bg);
  color: var(--foundation-accent);
}

.level-badge.core {
  background: var(--core-bg);
  color: var(--core-accent);
}

.level-badge.additional {
  background: var(--additional-bg);
  color: var(--additional-accent);
}

/* ─── NON-CALCULATOR BADGE ─── */
/* Used on all 6 Foundation topic pages (Paper 1 = non-calculator) */
.non-calc-badge {
  display: inline-block;
  background: #e8f5e9;
  color: #2e7d32;
  border: 1px solid #a5d6a7;
  border-radius: 4px;
  padding: 0.25rem 0.75rem;
  font-size: 0.85rem;
  font-weight: 600;
  margin: 0.5rem 0 1.5rem;
}

/* ─── FOOTER ─── */
footer {
  text-align: center;
  padding: 2rem 1rem;
  color: var(--text-muted);
  font-size: 0.85rem;
  border-top: 1px solid var(--border);
  margin-top: 2rem;
}

/* ================================
   KaTeX Equation Rendering
   ================================ */

/* KaTeX display equation overflow fix — applies to all topic pages */
/* Source: KaTeX GitHub issues #327 and #2942 */
.katex-display {
  overflow-x: auto;
  overflow-y: hidden;
  padding: 0.5em 0; /* prevents descender clipping */
}

.katex {
  font-size: 1.1em; /* slightly larger than body text for readability */
}

/* ─── PROGRESS OVERVIEW (homepage) ─── */
.progress-overview {
  margin: 2rem 0;
  background: var(--white);
  border: 1.5px solid var(--border);
  border-radius: 10px;
  padding: 1.25rem 1.5rem;
}
.progress-overview h2 {
  font-size: 1.05rem;
  font-weight: 700;
  margin-bottom: 1rem;
  color: var(--mh-navy);
}
.po-row {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  margin-bottom: 0.7rem;
  flex-wrap: wrap;
}
.po-level-name {
  font-weight: 700;
  font-size: 0.88rem;
  min-width: 90px;
  flex-shrink: 0;
  color: var(--text);
  text-decoration: none;
}
.po-level-name:hover { color: var(--mh-navy); }
.po-dots { display: flex; gap: 5px; flex-wrap: wrap; }
.po-dot {
  display: inline-block;
  width: 14px;
  height: 14px;
  border-radius: 50%;
}
.po-dot.po-green { background: #22c55e; }
.po-dot.po-amber { background: #f59e0b; }
.po-dot.po-red   { background: #ef4444; }
.po-dot.po-grey  { background: var(--border); }
.po-summary { display: flex; gap: 0.4rem; margin-left: auto; font-size: 0.78rem; flex-wrap: wrap; }
.po-count { padding: 1px 7px; border-radius: 99px; font-weight: 700; }
.po-count.po-green { background: #dcfce7; color: #15803d; }
.po-count.po-amber { background: #fef3c7; color: #d97706; }
.po-count.po-red   { background: #fee2e2; color: #dc2626; }
.po-count.po-grey  { background: var(--bg); color: var(--text-muted); }
.po-hint { font-size: 0.8rem; color: var(--text-muted); margin-top: 0.75rem; }

/* ─── QUICK CHECK ─── */
.quick-check {
  margin-top: 2.5rem;
  border-top: 2px solid var(--border);
  padding-top: 1.5rem;
}
.quick-check > h2 {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--mh-navy);
  margin-top: 0;
  margin-bottom: 1rem;
}
.qc-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1rem;
}
.qc-block {
  background: var(--white);
  border: 1.5px solid var(--border);
  border-radius: 8px;
  padding: 1rem 1.1rem;
}
.qc-q {
  font-weight: 600;
  margin-bottom: 0.75rem;
  line-height: 1.6;
}
.qc-btn {
  font-family: 'Dosis', sans-serif;
  font-size: 0.85rem;
  font-weight: 700;
  background: var(--mh-navy);
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 0.35rem 0.85rem;
  cursor: pointer;
}
.qc-btn:hover { background: var(--mh-navy-light); }
.qc-answer {
  margin-top: 0.65rem;
  font-weight: 700;
  color: var(--mh-navy);
  border-left: 3px solid var(--mh-navy);
  padding-left: 0.65rem;
  line-height: 1.7;
  background: rgba(0,83,76,0.05);
  padding: 0.5rem 0.65rem;
  border-radius: 0 4px 4px 0;
}

/* ─── RESPONSIVE ─── */
@media (max-width: 960px) {
  .level-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 600px) {
  .hero h1 {
    font-size: 1.5rem;
  }

  .level-grid {
    grid-template-columns: 1fr;
  }

  .header-inner {
    padding: 0.5rem 0.75rem;
    flex-wrap: wrap;
    gap: 0.4rem;
  }

  /* Nav scrolls horizontally on small screens */
  .header-nav {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    white-space: nowrap;
    padding-bottom: 4px;
    font-size: 0.82rem;
  }

  .hn-link {
    padding: 0.3rem 0.5rem;
  }

  .po-summary {
    margin-left: 0;
  }
}

/* ================================
   Desmos Interactive Graphs
   Used on: coordinates-graphs, straight-line-graphs, transformations
   ================================ */

.desmos-wrapper {
  position: relative;
  width: 100%;
  height: 400px;
  margin: 1.5rem 0;
  border-radius: 8px;
  overflow: hidden;
  border: 1px solid var(--border);
}

#desmos-calculator {
  width: 100%;
  height: 100%;
}

/* Mobile scroll-fix overlay — transparent div sits on top of Desmos.
   On touch devices, touching the graph triggers the overlay's touchstart,
   which delegates to a passive scroll on the parent page rather than
   letting Desmos capture the touch for panning.
   Users can still interact with Desmos by tapping the toggle button
   which adds class "interactive" to .desmos-wrapper and disables overlay. */
.desmos-scroll-overlay {
  position: absolute;
  inset: 0;
  z-index: 10;
  background: transparent;
  /* On desktop, pass pointer events through to Desmos */
  pointer-events: none;
}

@media (max-width: 900px) {
  .desmos-scroll-overlay {
    pointer-events: auto;
    touch-action: pan-y;
  }

  .desmos-wrapper.interactive .desmos-scroll-overlay {
    pointer-events: none;
  }

  .desmos-wrapper {
    height: 350px;
  }
}

.desmos-toggle-btn {
  display: none;
  background: var(--core-accent);
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 0.5rem 1rem;
  font-family: 'Dosis', sans-serif;
  font-size: 0.95rem;
  font-weight: 600;
  cursor: pointer;
  margin-bottom: 0.5rem;
}

@media (max-width: 900px) {
  .desmos-toggle-btn {
    display: block;
  }
}

/* ─── MENTAL ARITHMETIC ─── */

.ma-full {
  background: #fce7e7;
  border-color: var(--mh-gold);
}

.ma-level-btn {
  cursor: pointer;
  text-align: left;
  font-family: 'Dosis', sans-serif;
  background: inherit;
  border: inherit;
}

.ma-timer-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.75rem 1rem;
  background: var(--mh-navy);
  color: var(--white);
  border-radius: 8px;
  margin-bottom: 1.5rem;
  gap: 1rem;
  flex-wrap: wrap;
  position: sticky;
  top: 0;
  z-index: 100;
}

.ma-timer-centre {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.ma-timer-label {
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  opacity: 0.7;
}

#ma-timer {
  font-size: 2rem;
  font-weight: 700;
  font-variant-numeric: tabular-nums;
  line-height: 1;
}

#ma-progress {
  font-size: 1rem;
  font-weight: 600;
  opacity: 0.85;
  min-width: 5rem;
}

.ma-stop-btn {
  background: var(--mh-gold);
  color: var(--white);
  border: none;
  border-radius: 6px;
  padding: 0.5rem 1.2rem;
  min-height: 44px;
  font-family: 'Dosis', sans-serif;
  font-size: 1rem;
  font-weight: 700;
  cursor: pointer;
  transition: filter 0.15s;
}

.ma-stop-btn:hover {
  filter: brightness(1.12);
}

#ma-questions {
  list-style: none;
  padding: 0;
  counter-reset: q-counter;
}

.ma-question {
  counter-increment: q-counter;
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 0.65rem 0.75rem;
  border-bottom: 1px solid var(--border);
  flex-wrap: wrap;
}

.ma-question::before {
  content: counter(q-counter) ".";
  font-weight: 700;
  color: var(--text-muted);
  min-width: 2rem;
  flex-shrink: 0;
}

.ma-q-text {
  flex: 1;
  font-size: 1.05rem;
  font-weight: 500;
}

.ma-answer-input {
  width: 100px;
  min-height: 44px;
  padding: 0.35rem 0.5rem;
  border: 2px solid var(--border);
  border-radius: 6px;
  font-family: 'Dosis', sans-serif;
  font-size: 1rem;
  font-weight: 600;
  text-align: center;
  transition: border-color 0.15s, box-shadow 0.15s;
}

.ma-answer-input:focus {
  outline: none; /* replaced by box-shadow ring below */
  border-color: var(--mh-navy);
  box-shadow: 0 0 0 3px rgba(0, 83, 76, 0.18);
}

/* Results */
.ma-results-summary {
  background: var(--mh-navy);
  color: var(--white);
  border-radius: 8px;
  padding: 1.25rem 1.5rem;
  margin-bottom: 1.5rem;
  text-align: center;
}

.ma-score-big {
  display: block;
  font-size: 2rem;
  font-weight: 800;
  margin-bottom: 0.25rem;
}

.ma-time-taken {
  display: block;
  font-size: 1rem;
  opacity: 0.85;
}

#ma-results-list {
  list-style: none;
  padding: 0;
  counter-reset: r-counter;
}

.ma-result-item {
  counter-increment: r-counter;
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  padding: 0.65rem 0.75rem;
  border-bottom: 1px solid var(--border);
  flex-wrap: wrap;
}

.ma-result-item::before {
  content: counter(r-counter) ".";
  font-weight: 700;
  color: var(--text-muted);
  min-width: 2rem;
  flex-shrink: 0;
}

.ma-result-item .ma-q-text {
  font-size: 0.95rem;
}

.ma-result-mark {
  font-size: 0.9rem;
  font-weight: 600;
  white-space: nowrap;
}

.ma-correct .ma-result-mark { color: #16a34a; }
.ma-wrong .ma-result-mark   { color: #dc2626; }

.ma-retry-btn {
  padding: 0.6rem 1.5rem;
  min-height: 44px;
  background: var(--mh-navy);
  color: var(--white);
  border: none;
  border-radius: 6px;
  font-family: 'Dosis', sans-serif;
  font-size: 1rem;
  font-weight: 700;
  cursor: pointer;
  transition: background 0.15s;
}

.ma-retry-btn:hover {
  background: var(--mh-navy-light);
}

/* ── Mental Arithmetic — Feedback ─────────────────────────────────── */
.ma-feedback {
  margin: 1.5rem auto;
  max-width: 640px;
  padding: 1rem 1.25rem;
  background: #f8f9fa;
  border-radius: 10px;
  border-left: 4px solid var(--mh-navy);
}

.ma-feedback-good {
  margin: 0 0 0.5rem;
  color: #16a34a;
  font-size: 1rem;
}

.ma-feedback-improve {
  margin: 0.5rem 0 0.75rem;
  color: #374151;
  font-size: 0.95rem;
}

.ma-topic-links {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.ma-topic-link {
  display: inline-block;
  padding: 0.35rem 0.85rem;
  background: var(--mh-navy);
  color: var(--white);
  border-radius: 6px;
  text-decoration: none;
  font-size: 0.875rem;
  font-weight: 600;
  transition: background 0.15s;
}

.ma-topic-link:hover {
  background: var(--mh-navy-light);
}

.ma-topic-nolink {
  background: #9ca3af;
  cursor: default;
}

/* ── Past Papers ──────────────────────────────────────────────────── */
.info-banner {
  background: #f0f4ff;
  border-left: 4px solid var(--mh-navy);
  border-radius: 8px;
  padding: 0.85rem 1.1rem;
  margin-bottom: 1.5rem;
  font-size: 0.9rem;
  color: #374151;
  line-height: 1.5;
}

.pp-year-picker {
  display: flex;
  gap: 10px;
  margin: 0 0 1.75rem;
  flex-wrap: wrap;
}

.pp-year-btn {
  font-family: 'Dosis', sans-serif;
  font-weight: 700;
  font-size: 1rem;
  padding: 0.45rem 1.4rem;
  border-radius: 99px;
  border: 2.5px solid var(--mh-navy);
  background: #fff;
  color: var(--mh-navy);
  cursor: pointer;
  transition: background 0.15s, color 0.15s;
}

.pp-year-btn.active {
  background: var(--mh-navy);
  color: #fff;
}

.pp-year-btn:hover:not(.active) {
  background: #e8f0ef;
}

.pp-level-header {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  margin: 2rem 0 0.75rem;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid #e5e7eb;
}

.pp-level-header h2 {
  margin: 0;
  font-size: 1.3rem;
}

.pp-section {
  margin-bottom: 1.25rem;
}

.pp-section h3 {
  margin: 0 0 0.6rem;
  font-size: 1rem;
  color: #374151;
  font-weight: 600;
}

.pp-meta {
  font-weight: 400;
  font-size: 0.85rem;
  color: #6b7280;
  margin-left: 0.4rem;
}

.pp-paper-label {
  font-size: 0.95rem;
  font-weight: 700;
  color: var(--text-mid);
  margin: 0 0 0.6rem;
}

.pp-doc-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 0.85rem;
}

/* ── Document cards ── */
.pp-doc-card {
  display: flex;
  flex-direction: column;
  background: #fff;
  border: 2px solid #e5e7eb;
  border-radius: 14px;
  text-decoration: none;
  color: inherit;
  overflow: hidden;
  cursor: pointer;
  box-shadow: 0 1px 3px rgba(0,0,0,0.06);
  transition: border-color 0.15s, box-shadow 0.2s ease-out, transform 0.2s ease-out;
}

.pp-doc-card:hover {
  border-color: var(--mh-navy);
  box-shadow: 0 6px 18px rgba(0,83,76,0.12);
  transform: translateY(-2px);
}

/* Icon area */
.pp-doc-icon {
  padding: 1.5rem 1.5rem 1.25rem;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Exam paper icon colours — one per level */
.pp-icon-paper.pp-lv-foundation {
  background: var(--foundation-bg);
  color: var(--foundation-accent);
}

.pp-icon-paper.pp-lv-core {
  background: var(--core-bg);
  color: var(--core-accent);
}

.pp-icon-paper.pp-lv-additional {
  background: var(--additional-bg);
  color: var(--additional-accent);
}

.pp-icon-paper.pp-lv-mental {
  background: #fce7e7;
  color: var(--mh-gold);
}

/* Mark scheme — always green */
.pp-icon-ms {
  background: #dcfce7;
  color: #16a34a;
}

/* Card body */
.pp-doc-body {
  padding: 0.85rem 1rem 0.6rem;
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 0.2rem;
}

.pp-doc-type {
  font-size: 0.7rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-muted);
}

.pp-doc-name {
  font-size: 0.9rem;
  font-weight: 700;
  color: var(--text);
  line-height: 1.3;
}

/* Action bar */
.pp-doc-action {
  padding: 0.6rem 1rem;
  font-size: 0.85rem;
  font-weight: 700;
  color: var(--mh-navy);
  border-top: 1px solid #f0f0f0;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.pp-arrow {
  transition: transform 0.15s;
}

.pp-doc-card:hover .pp-arrow {
  transform: translateX(4px);
}

/* Mental Arithmetic level badge */
.pp-badge-mental {
  background: #fce7e7;
  color: var(--mh-gold);
  border: 1px solid rgba(129,0,28,0.2);
}

/* ─── ADDITIONAL LEVEL OVERRIDES ─── */
/* Scope Desmos toggle button to purple on Additional pages.
   Core pages use .desmos-toggle-btn { background: var(--core-accent) } (blue).
   Additional pages use .page-additional class on <body> to override. */
.page-additional .desmos-toggle-btn {
  background: var(--additional-accent);
}

/* ─── STEP REVEAL ─── */

.reveal-hidden {
  display: none;
}

.reveal-btn {
  display: inline-block;
  margin: 0.5rem 0 0.75rem;
  padding: 0.5rem 1.1rem;
  min-height: 44px;
  background: var(--mh-navy);
  color: var(--white);
  border: none;
  border-radius: 6px;
  font-family: 'Dosis', sans-serif;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.15s;
}

.reveal-btn:hover {
  background: var(--mh-navy-light);
}

/* ─── RAG TRACKER ─── */

.rag-selector {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin: 1rem 0 1.5rem;
  flex-wrap: wrap;
}

.rag-label {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-mid);
  margin-right: 0.25rem;
}

.rag-btn {
  border: 2px solid transparent;
  border-radius: 6px;
  padding: 0.5rem 1rem;
  min-height: 44px;
  font-family: 'Dosis', sans-serif;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  opacity: 0.5;
  color: white;
  transition: opacity 0.15s, box-shadow 0.15s;
}

.rag-btn.rag-red {
  background: #dc2626;
}

.rag-btn.rag-amber {
  background: #d97706;
}

.rag-btn.rag-green {
  background: #16a34a;
}

.rag-btn.rag-active {
  opacity: 1;
  border-color: rgba(0, 0, 0, 0.25);
  box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
}

.rag-index-badge {
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  margin-left: 0.5rem;
  vertical-align: middle;
}

.rag-index-badge.rag-red {
  background: #dc2626;
}

.rag-index-badge.rag-amber {
  background: #d97706;
}

.rag-index-badge.rag-green {
  background: #16a34a;
}

.rag-unavailable {
  font-size: 0.85rem;
  color: var(--text-muted);
  padding: 0.5rem 0.75rem;
  background: #fef9c3;
  border: 1px solid #fde047;
  border-radius: 6px;
  margin: 0.5rem 0 1.5rem;
}

@media print {
  .rag-selector,
  .rag-unavailable {
    display: none !important;
  }
}

/* ─── FORMULA SHEETS ─── */
.formula-section {
  margin: 1.5rem 0;
}

.formula-section h2 {
  font-size: 1.15rem;
  font-weight: 700;
  color: var(--mh-navy);
  margin-bottom: 0.5rem;
  border-bottom: 2px solid var(--mh-navy);
  padding-bottom: 0.25rem;
}

.formula-block {
  background: var(--white, #fff);
  border: 1px solid #e2e8f0;
  border-radius: 6px;
  padding: 0.75rem 1rem;
  margin: 0.5rem 0;
}

.formula-block p {
  margin: 0.2rem 0;
}

.formula-print-hint {
  font-size: 0.85rem;
  color: var(--text-muted, #64748b);
  margin-bottom: 1.25rem;
  padding: 0.5rem 0.75rem;
  background: #f8fafc;
  border: 1px solid #e2e8f0;
  border-radius: 6px;
}

/* ─── REDUCED MOTION ─── */
/* Disable all decorative animations for users who prefer it.
   Functional transitions (focus rings, input highlights) are kept. */
@media (prefers-reduced-motion: reduce) {
  .level-card,
  .topic-list a,
  .topic-list a::after,
  .rag-btn,
  .reveal-btn,
  .ma-topic-link,
  .ma-stop-btn,
  .ma-retry-btn,
  .pp-year-btn,
  .pp-card {
    transition: none;
  }

  .level-card:hover {
    transform: none;
  }

  .topic-list a:hover::after {
    transform: none;
  }
}

/* ─── PRINT: FORMULA SHEETS ─── */
@media print {
  @page {
    size: A4;
    margin: 1.5cm;
  }

  .site-header,
  .breadcrumb,
  footer,
  .formula-print-hint {
    display: none !important;
  }

  .formula-block {
    break-inside: avoid;
    page-break-inside: avoid; /* fallback for older Safari */
    border: 1px solid #ccc;
  }

  .formula-section h2 {
    break-after: avoid;
    page-break-after: avoid;
  }

  body {
    background: white;
    color: black;
  }

  .main-content {
    max-width: 100%;
    padding: 0;
  }
}
