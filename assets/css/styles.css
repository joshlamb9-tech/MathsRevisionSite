/* ============================================================
   MATHS REVISION — Year 8 CE  |  Mowden Hall
   Font: Dosis (Google Fonts)
   Colours: Mowden Hall brand colours (confirmed 2026-02-27)
            --mh-navy = Pantone 330C (dark green) #00534C
            --mh-gold = Pantone 704C (dark red)   #81001C
   ============================================================ */

@import url('https://fonts.googleapis.com/css2?family=Dosis:wght@300;400;500;600;700;800&display=swap');

/* ─── DESIGN TOKENS ─── */
:root {
  --mh-navy:         #00534C;   /* Pantone 330C — Mowden green */
  --mh-gold:         #81001C;   /* Pantone 704C — Mowden red   */
  --mh-navy-light:   #006b61;
  --bg:              #f4f2ef;
  --white:           #ffffff;
  --text:            #18181b;
  --text-mid:        #3f3f46;
  --text-muted:      #71717a;
  --border:          #e4e4e7;
  --foundation-bg:   #fef3c7;
  --foundation-accent: #d97706;
  --core-bg:         #dbeafe;
  --core-accent:     #2563eb;
  --additional-bg:   #ede9fe;
  --additional-accent: #7c3aed;
}

/* ─── RESET ─── */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

/* ─── BODY ─── */
body {
  font-family: 'Dosis', sans-serif;
  background: var(--bg);
  color: var(--text);
  overflow-x: hidden;
  line-height: 1.65;
}

/* ─── HEADER ─── */
.site-header {
  background: var(--mh-navy);
  color: var(--white);
}

.header-inner {
  max-width: 900px;
  margin: 0 auto;
  padding: 0.75rem 1rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.brand-name {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--white);
}

.brand-sub {
  font-size: 0.75rem;
  color: rgba(255, 255, 255, 0.7);
}

.header-nav {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
}

.hn-link {
  color: var(--white);
  text-decoration: none;
  font-weight: 500;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
}

.hn-link:hover {
  background: var(--mh-navy-light);
}

.hn-link.active {
  background: var(--mh-gold);
  color: var(--white);
}

/* ─── MAIN CONTENT ─── */
.main-content {
  max-width: 900px;
  margin: 0 auto;
  padding: 1.5rem 1rem;
}

/* ─── HERO ─── */
.hero {
  text-align: center;
  padding: 2rem 0 1.5rem;
}

.hero h1 {
  font-size: 2rem;
  font-weight: 800;
  color: var(--mh-navy);
  margin-bottom: 0.5rem;
}

.hero p {
  color: var(--text-mid);
  font-size: 1.1rem;
}

/* ─── LEVEL CARDS ─── */
.level-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1rem;
  margin-top: 1.5rem;
}

.level-card {
  display: block;
  border-radius: 8px;
  padding: 1.25rem;
  text-decoration: none;
  transition: transform 0.15s;
  border: 1px solid var(--border);
}

.level-card:hover {
  transform: translateY(-2px);
}

.level-card.foundation {
  background: var(--foundation-bg);
  border-color: var(--foundation-accent);
}

.level-card.core {
  background: var(--core-bg);
  border-color: var(--core-accent);
}

.level-card.additional {
  background: var(--additional-bg);
  border-color: var(--additional-accent);
}

.level-card h2 {
  font-size: 1.2rem;
  font-weight: 700;
  margin: 0 0 0.25rem;
}

.level-card p {
  font-size: 0.9rem;
  color: var(--text-mid);
  margin: 0;
}

/* ─── TOPIC LIST ─── */
.topic-list {
  list-style: none;
  padding: 0;
  margin: 1rem 0;
}

.topic-list li {
  margin: 0;
}

.topic-list a {
  display: block;
  padding: 0.6rem 0.75rem;
  border-radius: 6px;
  text-decoration: none;
  color: var(--text);
  border: 1px solid var(--border);
  margin-bottom: 0.5rem;
  font-weight: 500;
}

.topic-list a:hover {
  background: var(--white);
  border-color: var(--mh-navy);
}

/* ─── BREADCRUMB ─── */
.breadcrumb {
  font-size: 0.85rem;
  color: var(--text-muted);
  margin-bottom: 1rem;
}

.breadcrumb a {
  color: var(--text-mid);
  text-decoration: none;
}

.breadcrumb a:hover {
  text-decoration: underline;
}

/* ─── PAGE TITLE ─── */
.page-title {
  font-size: 1.6rem;
  font-weight: 800;
  color: var(--mh-navy);
  margin: 0 0 0.25rem;
}

/* ─── LEVEL BADGE ─── */
.level-badge {
  display: inline-block;
  font-size: 0.75rem;
  font-weight: 600;
  padding: 0.2rem 0.6rem;
  border-radius: 999px;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  margin-bottom: 1rem;
}

.level-badge.foundation {
  background: var(--foundation-bg);
  color: var(--foundation-accent);
}

.level-badge.core {
  background: var(--core-bg);
  color: var(--core-accent);
}

.level-badge.additional {
  background: var(--additional-bg);
  color: var(--additional-accent);
}

/* ─── NON-CALCULATOR BADGE ─── */
/* Used on all 6 Foundation topic pages (Paper 1 = non-calculator) */
.non-calc-badge {
  display: inline-block;
  background: #e8f5e9;
  color: #2e7d32;
  border: 1px solid #a5d6a7;
  border-radius: 4px;
  padding: 0.25rem 0.75rem;
  font-size: 0.85rem;
  font-weight: 600;
  margin: 0.5rem 0 1.5rem;
}

/* ─── FOOTER ─── */
footer {
  text-align: center;
  padding: 2rem 1rem;
  color: var(--text-muted);
  font-size: 0.85rem;
  border-top: 1px solid var(--border);
  margin-top: 2rem;
}

/* ================================
   KaTeX Equation Rendering
   ================================ */

/* KaTeX display equation overflow fix — applies to all topic pages */
/* Source: KaTeX GitHub issues #327 and #2942 */
.katex-display {
  overflow-x: auto;
  overflow-y: hidden;
  padding: 0.5em 0; /* prevents descender clipping */
}

.katex {
  font-size: 1.1em; /* slightly larger than body text for readability */
}

/* ─── RESPONSIVE ─── */
@media (max-width: 600px) {
  .hero h1 {
    font-size: 1.5rem;
  }

  .level-grid {
    grid-template-columns: 1fr;
  }

  .header-inner {
    padding: 0.5rem 0.75rem;
  }
}

/* ================================
   Desmos Interactive Graphs
   Used on: coordinates-graphs, straight-line-graphs, transformations
   ================================ */

.desmos-wrapper {
  position: relative;
  width: 100%;
  height: 400px;
  margin: 1.5rem 0;
  border-radius: 8px;
  overflow: hidden;
  border: 1px solid var(--border);
}

#desmos-calculator {
  width: 100%;
  height: 100%;
}

/* Mobile scroll-fix overlay — transparent div sits on top of Desmos.
   On touch devices, touching the graph triggers the overlay's touchstart,
   which delegates to a passive scroll on the parent page rather than
   letting Desmos capture the touch for panning.
   Users can still interact with Desmos by tapping the toggle button
   which adds class "interactive" to .desmos-wrapper and disables overlay. */
.desmos-scroll-overlay {
  position: absolute;
  inset: 0;
  z-index: 10;
  background: transparent;
  /* On desktop, pass pointer events through to Desmos */
  pointer-events: none;
}

@media (max-width: 900px) {
  .desmos-scroll-overlay {
    pointer-events: auto;
    touch-action: pan-y;
  }

  .desmos-wrapper.interactive .desmos-scroll-overlay {
    pointer-events: none;
  }

  .desmos-wrapper {
    height: 350px;
  }
}

.desmos-toggle-btn {
  display: none;
  background: var(--core-accent);
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 0.5rem 1rem;
  font-family: 'Dosis', sans-serif;
  font-size: 0.95rem;
  font-weight: 600;
  cursor: pointer;
  margin-bottom: 0.5rem;
}

@media (max-width: 900px) {
  .desmos-toggle-btn {
    display: block;
  }
}

/* ─── MENTAL ARITHMETIC ─── */

.ma-full {
  background: #fce7e7;
  border-color: var(--mh-gold);
}

.ma-level-btn {
  cursor: pointer;
  text-align: left;
  font-family: 'Dosis', sans-serif;
  background: inherit;
  border: inherit;
}

.ma-timer-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.75rem 1rem;
  background: var(--mh-navy);
  color: var(--white);
  border-radius: 8px;
  margin-bottom: 1.5rem;
  gap: 1rem;
  flex-wrap: wrap;
  position: sticky;
  top: 0;
  z-index: 100;
}

.ma-timer-centre {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.ma-timer-label {
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  opacity: 0.7;
}

#ma-timer {
  font-size: 2rem;
  font-weight: 700;
  font-variant-numeric: tabular-nums;
  line-height: 1;
}

#ma-progress {
  font-size: 1rem;
  font-weight: 600;
  opacity: 0.85;
  min-width: 5rem;
}

.ma-stop-btn {
  background: var(--mh-gold);
  color: var(--white);
  border: none;
  border-radius: 6px;
  padding: 0.5rem 1.2rem;
  font-family: 'Dosis', sans-serif;
  font-size: 1rem;
  font-weight: 700;
  cursor: pointer;
}

.ma-stop-btn:hover {
  filter: brightness(1.1);
}

#ma-questions {
  list-style: none;
  padding: 0;
  counter-reset: q-counter;
}

.ma-question {
  counter-increment: q-counter;
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 0.65rem 0.75rem;
  border-bottom: 1px solid var(--border);
  flex-wrap: wrap;
}

.ma-question::before {
  content: counter(q-counter) ".";
  font-weight: 700;
  color: var(--text-muted);
  min-width: 2rem;
  flex-shrink: 0;
}

.ma-q-text {
  flex: 1;
  font-size: 1.05rem;
  font-weight: 500;
}

.ma-answer-input {
  width: 100px;
  padding: 0.35rem 0.5rem;
  border: 2px solid var(--border);
  border-radius: 6px;
  font-family: 'Dosis', sans-serif;
  font-size: 1rem;
  font-weight: 600;
  text-align: center;
}

.ma-answer-input:focus {
  outline: none;
  border-color: var(--mh-navy);
}

/* Results */
.ma-results-summary {
  background: var(--mh-navy);
  color: var(--white);
  border-radius: 8px;
  padding: 1.25rem 1.5rem;
  margin-bottom: 1.5rem;
  text-align: center;
}

.ma-score-big {
  display: block;
  font-size: 2rem;
  font-weight: 800;
  margin-bottom: 0.25rem;
}

.ma-time-taken {
  display: block;
  font-size: 1rem;
  opacity: 0.85;
}

#ma-results-list {
  list-style: none;
  padding: 0;
  counter-reset: r-counter;
}

.ma-result-item {
  counter-increment: r-counter;
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  padding: 0.65rem 0.75rem;
  border-bottom: 1px solid var(--border);
  flex-wrap: wrap;
}

.ma-result-item::before {
  content: counter(r-counter) ".";
  font-weight: 700;
  color: var(--text-muted);
  min-width: 2rem;
  flex-shrink: 0;
}

.ma-result-item .ma-q-text {
  font-size: 0.95rem;
}

.ma-result-mark {
  font-size: 0.9rem;
  font-weight: 600;
  white-space: nowrap;
}

.ma-correct .ma-result-mark { color: #16a34a; }
.ma-wrong .ma-result-mark   { color: #dc2626; }

.ma-retry-btn {
  padding: 0.6rem 1.5rem;
  background: var(--mh-navy);
  color: var(--white);
  border: none;
  border-radius: 6px;
  font-family: 'Dosis', sans-serif;
  font-size: 1rem;
  font-weight: 700;
  cursor: pointer;
}

.ma-retry-btn:hover {
  background: var(--mh-navy-light);
}

/* ─── ADDITIONAL LEVEL OVERRIDES ─── */
/* Scope Desmos toggle button to purple on Additional pages.
   Core pages use .desmos-toggle-btn { background: var(--core-accent) } (blue).
   Additional pages use .page-additional class on <body> to override. */
.page-additional .desmos-toggle-btn {
  background: var(--additional-accent);
}

/* ─── STEP REVEAL ─── */

.reveal-hidden {
  display: none;
}

.reveal-btn {
  display: inline-block;
  margin: 0.5rem 0 0.75rem;
  padding: 0.4rem 1.1rem;
  background: var(--mh-navy);
  color: var(--white);
  border: none;
  border-radius: 6px;
  font-family: 'Dosis', sans-serif;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.15s;
}

.reveal-btn:hover {
  background: var(--mh-navy-light);
}

/* ─── RAG TRACKER ─── */

.rag-selector {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin: 1rem 0 1.5rem;
  flex-wrap: wrap;
}

.rag-label {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-mid);
  margin-right: 0.25rem;
}

.rag-btn {
  border: 2px solid transparent;
  border-radius: 6px;
  padding: 0.35rem 0.9rem;
  font-family: 'Dosis', sans-serif;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  opacity: 0.45;
  color: white;
  transition: opacity 0.1s;
}

.rag-btn.rag-red {
  background: #dc2626;
}

.rag-btn.rag-amber {
  background: #d97706;
}

.rag-btn.rag-green {
  background: #16a34a;
}

.rag-btn.rag-active {
  opacity: 1;
  border-color: rgba(0, 0, 0, 0.25);
  box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
}

.rag-index-badge {
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  margin-left: 0.5rem;
  vertical-align: middle;
}

.rag-index-badge.rag-red {
  background: #dc2626;
}

.rag-index-badge.rag-amber {
  background: #d97706;
}

.rag-index-badge.rag-green {
  background: #16a34a;
}

.rag-unavailable {
  font-size: 0.85rem;
  color: var(--text-muted);
  padding: 0.5rem 0.75rem;
  background: #fef9c3;
  border: 1px solid #fde047;
  border-radius: 6px;
  margin: 0.5rem 0 1.5rem;
}

@media print {
  .rag-selector,
  .rag-unavailable {
    display: none !important;
  }
}

/* ─── FORMULA SHEETS ─── */
.formula-section {
  margin: 1.5rem 0;
}

.formula-section h2 {
  font-size: 1.15rem;
  font-weight: 700;
  color: var(--mh-navy);
  margin-bottom: 0.5rem;
  border-bottom: 2px solid var(--mh-navy);
  padding-bottom: 0.25rem;
}

.formula-block {
  background: var(--white, #fff);
  border: 1px solid #e2e8f0;
  border-radius: 6px;
  padding: 0.75rem 1rem;
  margin: 0.5rem 0;
}

.formula-block p {
  margin: 0.2rem 0;
}

.formula-print-hint {
  font-size: 0.85rem;
  color: var(--text-muted, #64748b);
  margin-bottom: 1.25rem;
  padding: 0.5rem 0.75rem;
  background: #f8fafc;
  border: 1px solid #e2e8f0;
  border-radius: 6px;
}

/* ─── PRINT: FORMULA SHEETS ─── */
@media print {
  @page {
    size: A4;
    margin: 1.5cm;
  }

  .site-header,
  .breadcrumb,
  footer,
  .formula-print-hint {
    display: none !important;
  }

  .formula-block {
    break-inside: avoid;
    page-break-inside: avoid; /* fallback for older Safari */
    border: 1px solid #ccc;
  }

  .formula-section h2 {
    break-after: avoid;
    page-break-after: avoid;
  }

  body {
    background: white;
    color: black;
  }

  .main-content {
    max-width: 100%;
    padding: 0;
  }
}
